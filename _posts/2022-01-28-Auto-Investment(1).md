---
title: "자동 투자 Start!"
layout: post
date: 2022-01-28 22:01:00 +0900
category: Auto Investment
---

## 자동 투자 API

자동 투자를 하기 위해서는 증권사의 API가 필요하다.
그래서 대표적인 증권사 API 2곳을 비교해보고 어느 API로 시작할지 결정해보겠다.(인베스트랑 한투는 제외, 그러나 해외주식 매매가 가능한 API는 한투만 유일)

|                | 키움증권                                          | 크레온(대신증권)                                                              |
| -------------- | ------------------------------------------------- | ----------------------------------------------------------------------------- |
| API 연결 방식  | OCX                                               | COM                                                                           |
| 환경           | Window                                            | Window                                                                        |
| HTS검색식      | 분봉 단위 순위검색 미지원                         | 분봉 단위 순위 검색 지원                                                      |
| HTS 스탑로스   | 서버주문 지원 <br> 잔고자동편입 주문 지원(여러개) | 서버주문 지원(수수료)<br> 잔고자동편입 주문 지원 X (HTS 켜놓으면 가능)        |
| HTS 복기차트   | 틱단위                                            | 분단위                                                                        |
| 자동로그인     | 가능(코드 상에서 id,pw 노출 X)                    | 가능(코드 상에서 id,pw 노출 가능성있기에 스크립트로 로그인하고 프로그램 실행) |
| 요청 결과 방식 | 비동기                                            | 동기                                                                          |

---

각 API 마다 이러한 특징들이 있고
시장 상황, 여러가지를 고려해보았을 때

- 키움증권 API의 경우는 조건 검색도 가능하고 강력한 HTS 기능 때문에 주문과 매매에 있어서는 압도적이지만 Python에서 OCX 방식의 API를 사용하기 위해서 PyQt를 이용해야함.

- 대신증권 API의 경우는 요청 결과가 동기적으로 받을 수도 있고 COM 객체를 통해서 편하게 사용할 수 있으나 조건검색이 없어서 매매보다 데이터 수집이나 조회(API 사용성) 측면에서는 좋음.

## 결론

자동 투자의 방향은 두가지로 잡기로 하였다.

먼저, 대신증권 API를 이용해서 데이터를 수집하고 조회하여 전체적인 데이터베이스와 가치있는 데이터들을 골라내는 실력을 키우고

주식 거래 데이터를 이용해서 보는 눈이 생기면 키움 API를 이용해서 자동 투자 매매를 해보겠다!

## 참고

- 위에서 잔고 자동 편입 기능에 대해서 비교를 해보았는데, 잔고 편입 기능이란 현재 계좌에 보유하지 않은 종목이 매수를 통해서 잔고에 편입이 되면 보유 종목으로 자동 편입되는 것.

- OCX, COM, DLL의 차이
  - OCX : 윈도우 시스템 리소스의 공유를 기반, 마이크로소프트 윈도우에서 수행되는 응용프로그램에서 사용되기 위해 만들어질 수 있는 프로그램
  - COM : Component Object Model, 기존의 DDE를 보안하기 위해 발생한 OLE의 통신방법의 모델
