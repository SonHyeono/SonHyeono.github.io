---
title: "transit_center(5)"
categories:
  - Intern
feature_text: |
  The History of the 산학 R&D 프로젝트 인턴
---

**Table of Contents in this notebook[¶**](#Table-of-Contents-in-this-notebook)**

- [Chapter 1](#chapter1) Top39 데이터 전처리
- [Chapter 2](#chapter2) 후보지 10곳의 8가지 점수 구하기

**Chapter 1 [¶**](#Chapter-1-)**

**Top39 데이터 전처리[¶**](#Top39-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC)**

In [1]:

**import** pandas **as** pd

bus\_on **=** pd**.**read\_excel('C:/jupyter\_data/Top39평일승차수.xlsx')

bus\_off **=** pd**.**read\_excel('C:/jupyter\_data/Top39평일하차수.xlsx')

sub\_on **=** pd**.**read\_excel('C:/jupyter\_data/승차역\_상위40개\_좌표.xlsx')

sub\_off **=** pd**.**read\_excel('C:/jupyter\_data/하차역\_상위40개\_좌표.xlsx')

bus\_on**.**head(10)

Out[1]:

||**승차\_정류장ARS**|**정류장명**|**1월\_평일승차수**|**2월\_평일승차수**|**3월\_평일승차수**|**4월\_평일승차수**|**5월\_평일승차수**|**6월\_평일승차수**|**7월\_평일승차수**|**8월\_평일승차수**|**9월\_평일승차수**|**정류장\_승객수총합**|**정류장\_승객수평균**|**X좌표**|**Y좌표**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|17014|구로디지털단지역환승센터(17014.0)|8861|9436|9606|9330|9495|9626|8875|9232|3018|77479|8608.777778|126.902006|37.484607|
|**1**|22019|고속터미널(22019.0)|7361|8113|8795|8606|9557|8525|7399|7576|5561|71493|7943.666667|127.005263|37.506335|
|**2**|9012|미아사거리역(9012.0)|7624|8112|8754|8708|9083|8602|8128|8109|3812|70932|7881.333333|127.030240|37.612897|
|**3**|22012|지하철2호선강남역(22012.0)|6915|7897|8452|7984|9354|8224|7455|7575|2457|66313|7368.111111|127.026418|37.500757|
|**4**|9004|수유역.강북구청(9004.0)|6950|7525|7817|8050|8163|7430|7405|7575|3450|64365|7151.666667|127.025183|37.637522|
|**5**|19112|경방타임스퀘어.신세계백화점(19112.0)|6644|7490|7819|7387|8232|7434|7088|7107|3949|63150|7016.666667|126.906191|37.517492|
|**6**|22289|양재역(22289.0)|6712|7378|7632|7623|7627|7550|6685|7048|1371|59626|6625.111111|127.034999|37.483382|
|**7**|21350|신림사거리.신림역(21350.0)|6170|6824|7037|6929|7139|6905|6352|6547|2768|56671|6296.777778|126.928285|37.484152|
|**8**|23408|수서역(23408.0)|6267|6809|7300|7241|7455|7115|6128|6433|1745|56493|6277.000000|127.101829|37.486832|
|**9**|17001|신도림역(17001.0)|6252|6713|7062|6994|7434|7235|6160|6237|2168|56255|6250.555556|126.889413|37.509765|
In [2]:

**import** numpy **as** np


sub\_on["승차역"] **=** np**.**nan

**for** idx **in** sub\_on**.**index:

`    `code **=**  sub\_on**.**iloc[idx]['code']**.**astype(np**.**string\_)**.**decode('UTF-8')

`    `sub\_on**.**loc[idx,'승차역'] **=** sub\_on**.**iloc[idx]['승차\_역'] **+**"(" **+** sub\_on**.**iloc[idx]['승차\_호선'] **+** code **+** ")" 



sub\_off["하차역"] **=** np**.**nan

**for** idx **in** sub\_off**.**index:

`    `code **=**  sub\_off**.**iloc[idx]['code']**.**astype(np**.**string\_)**.**decode('UTF-8')

`    `sub\_off**.**loc[idx,'하차역'] **=** sub\_off**.**iloc[idx]['하차\_역'] **+**"(" **+** sub\_off**.**iloc[idx]['하차\_호선'] **+** code **+** ")"



sub\_on**.**head(10)

Out[2]:

||**Unnamed: 0**|**승차\_호선**|**승차\_역**|**1월\_승차수**|**2월\_승차수**|**3월\_승차수**|**4월\_승차수**|**5월\_승차수**|**6월\_승차수**|**7월\_승차수**|**8월\_승차수**|**9월\_승차수**|**10월\_승차수**|**총합\_승차인원**|**평균\_승차인원**|**code**|**lat**|**lng**|**승차역**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|0|2호선|강남|72088|83098|82836|79967|89662|83459|41718|70973|75091|35778|1.559280e+06|200324.166667|222|37.497175|127.027926|강남(2호선222)|
|**1**|1|2호선|잠실|52971|60582|61182|61797|68262|66216|40765|53966|59949|54691|1.266286e+06|162682.553030|216|37.513950|127.102234|잠실(2호선216)|
|**2**|2|2호선|신림|54733|58481|61130|61441|65032|61945|37650|55290|59255|36504|1.203188e+06|154576.189394|230|37.484201|126.929715|신림(2호선230)|
|**3**|3|2호선|구로디지털단지|54542|58788|62667|62305|64071|62174|24908|53589|57052|23542|1.142483e+06|146777.318182|232|37.485266|126.901401|구로디지털단지(2호선232)|
|**4**|4|2호선|선릉|51215|54706|57245|56314|59073|57602|16914|50787|53899|13441|1.028064e+06|132077.666667|220|37.504503|127.049008|선릉(2호선220)|
|**5**|5|2호선|홍대입구|37355|45638|44987|43322|52994|48459|36445|40794|44628|51487|9.733287e+05|125045.704545|239|37.557192|126.925381|홍대입구(2호선239)|
|**6**|6|2호선|삼성|43311|48345|49635|48596|53838|52087|18274|45152|47109|19779|9.297295e+05|119444.409091|219|37.508844|127.063160|삼성(2호선219)|
|**7**|7|2호선|역삼|45951|50332|51280|51123|52740|52884|12753|48465|49051|10864|9.282393e+05|119252.962121|221|37.500622|127.036456|역삼(2호선221)|
|**8**|8|2호선|신도림|41116|45058|47519|47680|51024|49515|26210|41792|44821|28775|9.240218e+05|118711.136364|234|37.508725|126.891295|신도림(2호선234)|
|**9**|9|2호선|서울대입구|39685|43381|45984|46098|49067|47082|27939|41433|44598|27337|9.002269e+05|115654.151515|228|37.481247|126.952739|서울대입구(2호선228)|
**Chapter 2 [¶**](#Chapter-2-)**

**후보지 10곳의 8가지 점수 구하기[¶**](#%ED%9B%84%EB%B3%B4%EC%A7%80-10%EA%B3%B3%EC%9D%98-8%EA%B0%80%EC%A7%80-%EC%A0%90%EC%88%98-%EA%B5%AC%ED%95%98%EA%B8%B0)**

In [3]:

*# 환승센터 후보지들 위치 뽑아오기*

In [4]:

candidate **=** pd**.**DataFrame({'Hubs':['쌍문역(10016.0)', '수유(4호선414)','미아사거리(4호선416)', '고속터미널(22020.0)', 

`                             `'서울대입구역(21330.0)', '신림(2호선230)','신도림역(17001.0)', '합정(2호선238)',

`                             `'홍대입구역(14016.0)','강남(2호선222)'],

`                             `'lat': "",

`                             `'lng':"" , '500m안 정류장개수':"", '500m안 역 개수':"", '노선 개수':"", '차선 개수':"",'환승주차장\_개수':"",

`                             `'노선 길이 \* 총운행횟수':"", '교통인구':"",'기존환승센터와의 거리':""})

candidate

Out[4]:

||**Hubs**|**lat**|**lng**|**500m안 정류장개수**|**500m안 역 개수**|**노선 개수**|**차선 개수**|**환승주차장\_개수**|**노선 길이 \* 총운행횟수**|**교통인구**|**기존환승센터와의 거리**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|쌍문역(10016.0)|||||||||||
|**1**|수유(4호선414)|||||||||||
|**2**|미아사거리(4호선416)|||||||||||
|**3**|고속터미널(22020.0)|||||||||||
|**4**|서울대입구역(21330.0)|||||||||||
|**5**|신림(2호선230)|||||||||||
|**6**|신도림역(17001.0)|||||||||||
|**7**|합정(2호선238)|||||||||||
|**8**|홍대입구역(14016.0)|||||||||||
|**9**|강남(2호선222)|||||||||||
In [5]:

bus\_on**.**rename(columns**=**{'X좌표':'lng'},inplace **=** **True**)

bus\_on**.**rename(columns**=**{'Y좌표':'lat'},inplace **=** **True**)

bus\_off**.**rename(columns**=**{'X좌표':'lng'},inplace **=** **True**)

bus\_off**.**rename(columns**=**{'Y좌표':'lat'},inplace **=** **True**)

bus\_off**.**head(2)

Out[5]:

||**하차\_정류장ARS**|**정류장명**|**1월\_평일하차수**|**2월\_평일하차수**|**3월\_평일하차수**|**4월\_평일하차수**|**5월\_평일하차수**|**6월\_평일하차수**|**7월\_평일하차수**|**8월\_평일하차수**|**9월\_평일하차수**|**정류장\_승객수총합**|**정류장\_승객수평균**|**lng**|**lat**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|21001|구로디지털단지역(21001.0)|10909|11980|12528|12235|12656|12179|10780|11217|10909|105393|11710.333333|126.902448|37.483934|
|**1**|17014|구로디지털단지역환승센터(17014.0)|8276|8909|9080|9063|9460|9182|8497|8536|8276|79279|8808.777778|126.902006|37.484607|
In [6]:

**for** idx **in** candidate**.**index:

`    `hub **=** candidate**.**loc[idx,'Hubs']



`    `df\_bn **=** bus\_on[bus\_on['정류장명']**.**isin([hub])]

`    `df\_bf **=** bus\_off[bus\_off['정류장명']**.**isin([hub])]

`    `df\_sn **=** sub\_on[sub\_on['승차역']**.**isin([hub])]

`    `df\_sf **=** sub\_off[sub\_off['하차역']**.**isin([hub])]



`    `**if** df\_bn**.**empty **==** **False**:

`        `lng **=** df\_bn['lng']

`        `lat **=** df\_bn['lat']

`    `**elif** df\_bf**.**empty **==** **False**:

`        `lng **=** df\_bf['lng']

`        `lat **=** df\_bf['lat']

`    `**elif** df\_sn**.**empty **==** **False**:

`        `lng **=** df\_sn['lng']

`        `lat **=** df\_sn['lat']

`    `**elif** df\_sf**.**empty **==** **False**:

`        `lng **=** df\_sf['lng']

`        `lat **=** df\_sf['lat']

`    `candidate**.**loc[idx,'lng'] **=** lng**.**values[0]

`    `candidate**.**loc[idx,'lat'] **=** lat**.**values[0]

In [7]:

candidate

Out[7]:

||**Hubs**|**lat**|**lng**|**500m안 정류장개수**|**500m안 역 개수**|**노선 개수**|**차선 개수**|**환승주차장\_개수**|**노선 길이 \* 총운행횟수**|**교통인구**|**기존환승센터와의 거리**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|쌍문역(10016.0)|37.648063|127.034482|||||||||
|**1**|수유(4호선414)|37.638052|127.025732|||||||||
|**2**|미아사거리(4호선416)|37.613292|127.030053|||||||||
|**3**|고속터미널(22020.0)|37.505637|127.003841|||||||||
|**4**|서울대입구역(21330.0)|37.480696|126.95249|||||||||
|**5**|신림(2호선230)|37.484201|126.929715|||||||||
|**6**|신도림역(17001.0)|37.509765|126.889413|||||||||
|**7**|합정(2호선238)|37.549463|126.913739|||||||||
|**8**|홍대입구역(14016.0)|37.557534|126.924522|||||||||
|**9**|강남(2호선222)|37.497175|127.027926|||||||||
In [8]:

**import** os

**import** folium

**import** folium **as** g

F\_hub **=** folium**.**FeatureGroup("F\_hub")

center **=** [37.541, 126.986]

m **=** folium**.**Map(location**=**center, zoom\_start**=**11)

**for** i **in** candidate**.**index:

`    `long **=** candidate**.**loc[i,'lng']

`    `lat  **=** candidate**.**loc[i,'lat']



`    `title **=** candidate**.**loc[i,'Hubs']



`    `color **=** 'red'

`    `g**.**Marker([lat,long],tooltip**=**title,icon **=** (folium**.**Icon(icon**=**"star", prefix**=**"fa", color**=**"red")))**.**add\_to(F\_hub)

F\_hub**.**add\_to(m)

m**.**save('example.html')

m

Out[8]:

Make this Notebook Trusted to load map: File -> Trust Notebook

In [9]:

*# 후보지 주변 직선 거리로 해서 교통수단과 노선의 개수를 구하기 위해서 distance 함수를 만듬.*

In [10]:

**def** distance(s\_lat, s\_lng, e\_lat, e\_lng):



`    `*# approximate radius of earth in km*

`    `R **=** 6373.0



`    `s\_lat **=** s\_lat**\***np**.**pi**/**180.0                      

`    `s\_lng **=** np**.**deg2rad(s\_lng)     

`    `e\_lat **=** np**.**deg2rad(e\_lat)                       

`    `e\_lng **=** np**.**deg2rad(e\_lng)  



`    `d **=** np**.**sin((e\_lat **-** s\_lat)**/**2)**\*\***2 **+** np**.**cos(s\_lat)**\***np**.**cos(e\_lat) **\*** np**.**sin((e\_lng **-** s\_lng)**/**2)**\*\***2



`    `**return** 2 **\*** R **\*** np**.**arcsin(np**.**sqrt(d)) 

In [11]:

*# 후보지 근처 500안에 지하철과 버스 정류장이 몇개 있는지 수를 계산.* 

In [12]:

bus\_stop **=** pd**.**read\_csv('C:/jupyter\_data/서울시버스정류소좌표데이터(2021.01.14.).csv')

bus\_stop**.**head(5)

Out[12]:

||**표준ID**|**ARS-ID**|**정류소명**|**X좌표**|**Y좌표**|
| -: | -: | -: | -: | -: | -: |
|**0**|100000001|1001|종로2가사거리|126.987786|37.569764|
|**1**|100000002|1002|창경궁.서울대학교병원|126.996520|37.579179|
|**2**|100000003|1003|명륜3가.성대입구|126.998290|37.582709|
|**3**|100000004|1004|종로2가.삼일교|126.987507|37.568582|
|**4**|100000005|1005|혜화동로터리.여운형활동터|127.001694|37.586230|
In [13]:

station **=** pd**.**read\_csv('C:/jupyter\_data/station\_coordinate.csv',encoding**=**'cp949')

station**.**head(5)

Out[13]:

||**line**|**name**|**code**|**lat**|**lng**|
| -: | -: | -: | -: | -: | -: |
|**0**|01호선|녹양|1908.0|37.759380|127.042292|
|**1**|01호선|남영|1002.0|37.541021|126.971300|
|**2**|01호선|용산|1003.0|37.529849|126.964561|
|**3**|01호선|노량진|1004.0|37.514219|126.942454|
|**4**|01호선|대방|1005.0|37.513342|126.926382|
In [14]:

*# 이때 후보지로 잡은 위치가 해당 위치의 정류장 혹은 역으로 잡은 것이라서 좌표가 같은 곳도 count해줘야함. 후보지 위치에서 역과 정류장의* 

*# 개수이니깐 후보지로 잡은 곳도 count해줘야함.*

**for** idx **in** candidate**.**index:

`    `bus\_count **=** 0

`    `station\_count **=** 0 

`    `**for** i **in** bus\_stop**.**index:

`        `**if** distance(candidate**.**loc[idx,'lat'],candidate**.**loc[idx,'lng'] , bus\_stop**.**loc[i,'Y좌표'] , bus\_stop**.**loc[i,'X좌표']) **<=** 0.5:

`            `bus\_count **=** bus\_count **+** 1



`    `**for** j **in** station**.**index:

`        `**if** distance(candidate**.**loc[idx,'lat'],candidate**.**loc[idx,'lng'], station**.**loc[j,'lat'], station**.**loc[j,'lng']) **<=** 0.5:

`            `station\_count **=** station\_count **+** 1



`    `candidate**.**loc[idx,'500m안 정류장개수'] **=** bus\_count

`    `candidate**.**loc[idx,'500m안 역 개수'] **=** station\_count

candidate *# ex 홍대의 경우 경중선, 2호선, 공항철도*

Out[14]:

||**Hubs**|**lat**|**lng**|**500m안 정류장개수**|**500m안 역 개수**|**노선 개수**|**차선 개수**|**환승주차장\_개수**|**노선 길이 \* 총운행횟수**|**교통인구**|**기존환승센터와의 거리**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|쌍문역(10016.0)|37.648063|127.034482|24|1|||||||
|**1**|수유(4호선414)|37.638052|127.025732|37|1|||||||
|**2**|미아사거리(4호선416)|37.613292|127.030053|30|1|||||||
|**3**|고속터미널(22020.0)|37.505637|127.003841|19|3|||||||
|**4**|서울대입구역(21330.0)|37.480696|126.95249|20|1|||||||
|**5**|신림(2호선230)|37.484201|126.929715|28|1|||||||
|**6**|신도림역(17001.0)|37.509765|126.889413|19|2|||||||
|**7**|합정(2호선238)|37.549463|126.913739|26|2|||||||
|**8**|홍대입구역(14016.0)|37.557534|126.924522|28|3|||||||
|**9**|강남(2호선222)|37.497175|127.027926|38|2|||||||
In [15]:

*# 후보지 500m 안에서 지나가는 노선의 개수는 500m 안에 있는 정류장들을 조사해 어느 노선인지 파악후 중복값을 제거하면* 

*# 500m 안의 노선개수가 나옴.*

In [16]:

line **=** list()

**for** idx **in** candidate**.**index:

`    `d **=** list()

`    `**for** i **in** bus\_stop**.**index:

`        `**if** distance(candidate**.**loc[idx,'lat'],candidate**.**loc[idx,'lng'] , bus\_stop**.**loc[i,'Y좌표'] , bus\_stop**.**loc[i,'X좌표']) **<=** 0.5:

`            `d**.**append(bus\_stop**.**loc[i,'ARS-ID'])

`    `line**.**append(d)



*# 후보지 9개에 대해서 list로 500m 안의 정류장의 ARS-ID를 추가함.*



In [17]:

*# 1월만 한 이유는 1월 전체 정류장 데이터 개수가 서울시 정류장 데이터 개수보다 많기 때문이다. 즉 1월 19일에 한명도 타지 않은 정류장은* 

*# 없기 때문이다.*

busroute\_0119 **=** pd**.**read\_csv('C:/jupyter\_data/노선별\_OD\_20210119.csv')

busroute\_0119**.**dropna()

*# 여기서 duplicate로 정류장별로 중복을 제거하게 되면 승차 정류장의 중복을 제거해버리다 보면 하차 정류장의 개수가 줄어들어* 

*# 혹시라도 하자 정류장 ARS가 날라갈 수도 있다.*

busroute\_0119**.**head(5)

C:\Users\ok762\.conda\envs\py38\lib\site-packages\IPython\core\interactiveshell.py:3172: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low\_memory=False.

`  `has\_raised = await self.run\_ast\_nodes(code\_ast.body, cell\_name,

Out[17]:

||**기준일자**|**노선명**|**승차\_정류장ARS**|**승차\_정류장명**|**하차\_정류장ARS**|**하차\_정류장명**|**승차\_정류장순번**|**하차\_정류장순번**|**승객수**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|20210119|17|3689.0|청암자이아파트|3247.0|용문시장|1.0|9.0|1|
|**1**|20210119|17|3689.0|청암자이아파트|3250.0|용산전자상가입구|1.0|10.0|1|
|**2**|20210119|17|3689.0|청암자이아파트|3252.0|신용산.지하차도|1.0|11.0|1|
|**3**|20210119|17|3689.0|청암자이아파트|3255.0|용산역|1.0|12.0|6|
|**4**|20210119|17|3689.0|청암자이아파트|3298.0|청암동강변삼성아파트|1.0|2.0|1|
In [18]:

*# for문을 돌려서 line안의 list들에서 노선을 추출후 노선의 개수를 구하고 candidate에 집어 넣는 과정.* 

*# (새로운 list에다가 list안에 없는 노선일 경우 list에 append 시키기)*

rem\_line **=** list()

**for** idx **in** candidate**.**index:

`    `line\_size **=** list()

`    `**for** i **in** range(len(line[idx])):

`        `df\_line **=** busroute\_0119[ (busroute\_0119['승차\_정류장ARS'] **==** line[idx][i]) **|** (busroute\_0119['하차\_정류장ARS'] **==** line[idx][i])]

`        `*# 이때 | 을 써서 분리할꺼면 ( ) | ( )  이렇게 괄호로 묶어줘야함.*

`        `line\_name **=** df\_line['노선명']

`        `**if** line\_name**.**size **!=** 0: *# line\_name의 경우 size가 0인 경우가 나와서 안 걸러주면 line\_name.values[0]이 없는 값의 [0]을 찾게 되니깐 오류가 남.*

`            `line\_size**.**append(line\_name**.**values[0])



`    `my\_list **=** set(line\_size)  *# list에서 중복을 제거하기 위해서 리스트를 집합set으로 변환하고 다시 list로 변환하면 중복이 제거 됨.*

`    `line\_size **=** list(my\_list)

`    `print(line\_size)

`    `rem\_line**.**append(line\_size)

`    `candidate**.**loc[idx,'노선 개수'] **=** len(line\_size)



candidate

['1127', '도봉01', '1126', '106', '노원14', '도봉07', '101', '도봉05']

['1119', '1124', '도봉02', '102', '강북02', '1127', '710', '강북01', '강북09', '1126', '1218', '강북04', '1120', '101']

['100', '성북10-1', '1124', '강북08', '1116', '강북09', '성북09', '1137', '1128', '강북05', '1115', '101']

['3414', '3422', '143', '142', '405', '서초14', '서초13', '540', '서초10']

['관악07', '5511', '461', '5517', '501', '5524', '관악04']

['관악05', '관악03', '461', '5519', '500', '5524', 152, '관악11', '506']

[160, '구로09', '6649', '영등포05', '6411', '6611', '5619', '양천04', '영등포01']

['마포07', '5712', '271A', '7011', '마포16']

['110A고려대', '마포09', '110B국민대', '마포16', '7016', '7734', '마포06', 270, '271A', '273', '마포05', '마포15', '마포08', '7711']

['145', '146', '서초10', '643', '340', '740', '서초09', '9711A', '3412', '144', '서초03', '140', '서초11']

Out[18]:

||**Hubs**|**lat**|**lng**|**500m안 정류장개수**|**500m안 역 개수**|**노선 개수**|**차선 개수**|**환승주차장\_개수**|**노선 길이 \* 총운행횟수**|**교통인구**|**기존환승센터와의 거리**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|쌍문역(10016.0)|37.648063|127.034482|24|1|8||||||
|**1**|수유(4호선414)|37.638052|127.025732|37|1|14||||||
|**2**|미아사거리(4호선416)|37.613292|127.030053|30|1|12||||||
|**3**|고속터미널(22020.0)|37.505637|127.003841|19|3|9||||||
|**4**|서울대입구역(21330.0)|37.480696|126.95249|20|1|7||||||
|**5**|신림(2호선230)|37.484201|126.929715|28|1|9||||||
|**6**|신도림역(17001.0)|37.509765|126.889413|19|2|9||||||
|**7**|합정(2호선238)|37.549463|126.913739|26|2|5||||||
|**8**|홍대입구역(14016.0)|37.557534|126.924522|28|3|14||||||
|**9**|강남(2호선222)|37.497175|127.027926|38|2|13||||||
In [19]:

road\_count **=** [7,6,6,9,7,8,8,10,8,11]

**for** i **in** candidate**.**index:

`    `candidate**.**loc[i,'차선 개수'] **=** road\_count[i]

candidate

Out[19]:

||**Hubs**|**lat**|**lng**|**500m안 정류장개수**|**500m안 역 개수**|**노선 개수**|**차선 개수**|**환승주차장\_개수**|**노선 길이 \* 총운행횟수**|**교통인구**|**기존환승센터와의 거리**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|쌍문역(10016.0)|37.648063|127.034482|24|1|8|7|||||
|**1**|수유(4호선414)|37.638052|127.025732|37|1|14|6|||||
|**2**|미아사거리(4호선416)|37.613292|127.030053|30|1|12|6|||||
|**3**|고속터미널(22020.0)|37.505637|127.003841|19|3|9|9|||||
|**4**|서울대입구역(21330.0)|37.480696|126.95249|20|1|7|7|||||
|**5**|신림(2호선230)|37.484201|126.929715|28|1|9|8|||||
|**6**|신도림역(17001.0)|37.509765|126.889413|19|2|9|8|||||
|**7**|합정(2호선238)|37.549463|126.913739|26|2|5|10|||||
|**8**|홍대입구역(14016.0)|37.557534|126.924522|28|3|14|8|||||
|**9**|강남(2호선222)|37.497175|127.027926|38|2|13|11|||||
In [20]:

*# 지금부터는 후보지 500m이내에 환승주차장의 개수를 구해보겠음. 환승주차장의 수를 구하는 이유는 환승주차장은 환승하는 사람들이 자가용을* 

*# 타고와서 환승주차장으로서 이용하는 주차장으로 환승센터에서 필수요소.*

*# 출차 시, 지하철 탈 때 사용한 카드로 주차요금 결제하고 환승 할인 받는다.(지하철을 이용, 도착 후 30분 이내 정산 시에만 할인적용)* 

*# 출차 시, 30분 이내 지하철 이용이 확인되면 주차 요금 할인을 받는다.*

*# 등등을 혜택받음 http://www.seoulmetro.co.kr/kr/page.do?menuIdx=540 밑에 혜택이 설명이 되어있음.*

In [21]:

*# 이 데이터는 http://www.seoulmetro.co.kr/kr/page.do?menuIdx=540  서울교통공사에서 찾은 환승주차장들의 위치(역에서 300m내의 환승주차장)*

parking **=** pd**.**read\_excel('C:/jupyter\_data/환승주차장좌표.xlsx')

parking

Out[21]:

||**name**|**lng**|**lat**|
| -: | -: | -: | -: |
|**0**|사당노외주차장|126.984156|37.475508|
|**1**|신대방역 공영주차장|126.913271|37.487513|
|**2**|신천유수지 공영주차장|127.103222|37.521818|
|**3**|구로디지털단지역1환승주차장|126.901156|37.485176|
|**4**|구로디지털단지역2카드전용환승주차장|126.902230|37.485470|
|**5**|학여울역 환승공영주차장|127.072319|37.497117|
|**6**|수서역 공영주차장|127.100016|37.487948|
|**7**|구파발역 공영주차장|126.919164|37.638582|
|**8**|창동역(서) 환승공영주차장|127.045736|37.652466|
|**9**|방화(동) 공영주차장|126.813252|37.577401|
|**10**|방화(서) 공영주차장|126.812116|37.577493|
|**11**|개화산역 환승주차장|126.804862|37.572275|
|**12**|영등포구청역 공영주차장|126.895602|37.524310|
|**13**|당산노외 공영주차장|126.899477|37.526222|
|**14**|신길역 환승주차장|126.917444|37.516257|
|**15**|마포유수지 공영주차장|126.943058|37.539307|
|**16**|천호역 공영주차장|127.125311|37.537832|
|**17**|명일동 주차장|127.156240|37.553563|
|**18**|한강진역 환승주차장|127.002659|37.539777|
|**19**|석계역 공영주차장|127.064712|37.616581|
|**20**|화랑대역 환승주차장|127.086969|37.619940|
|**21**|봉화산(남) 공영주차장|127.091923|37.616474|
|**22**|장암역 환승주차장|127.054182|37.700688|
|**23**|도봉산역 환승주차장|127.044474|37.690000|
|**24**|수락산역 환승주차장|127.055858|37.679076|
|**25**|대림노외 공영주차장|126.895239|37.491160|
|**26**|천왕역 광역환승센터|126.839158|37.487261|
|**27**|복정역 환승주차장|127.127953|37.470144|
|**28**|산성역 환승주차장|127.150807|37.456794|
In [22]:

**import** os

**import** folium

**import** folium **as** g

F\_park **=** folium**.**FeatureGroup("F\_park")

center **=** [37.541, 126.986]

m **=** folium**.**Map(location**=**center, zoom\_start**=**11)

**for** i **in** parking**.**index:

`    `long **=** parking**.**loc[i,'lng']

`    `lat  **=** parking**.**loc[i,'lat']



`    `title **=** parking**.**loc[i,'name']



`    `color **=** 'red'

`    `g**.**Marker([lat,long],tooltip**=**title,icon **=** (folium**.**Icon(icon**=**"star", prefix**=**"fa", color**=**"red")))**.**add\_to(F\_park)

F\_park**.**add\_to(m)

m**.**save('example.html')

m

Out[22]:

Make this Notebook Trusted to load map: File -> Trust Notebook

In [23]:

**for** idx **in** candidate**.**index:

`    `park\_count **=** 0

`    `**for** i **in** parking**.**index:

`        `**if** distance(candidate**.**loc[idx,'lat'],candidate**.**loc[idx,'lng'] , parking**.**loc[i,'lat'] , parking**.**loc[i,'lng']) **<=** 1.5:

`            `park\_count **=** park\_count **+** 1



`    `candidate**.**loc[idx,'환승주차장\_개수'] **=** park\_count



candidate







Out[23]:

||**Hubs**|**lat**|**lng**|**500m안 정류장개수**|**500m안 역 개수**|**노선 개수**|**차선 개수**|**환승주차장\_개수**|**노선 길이 \* 총운행횟수**|**교통인구**|**기존환승센터와의 거리**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|쌍문역(10016.0)|37.648063|127.034482|24|1|8|7|1||||
|**1**|수유(4호선414)|37.638052|127.025732|37|1|14|6|0||||
|**2**|미아사거리(4호선416)|37.613292|127.030053|30|1|12|6|0||||
|**3**|고속터미널(22020.0)|37.505637|127.003841|19|3|9|9|0||||
|**4**|서울대입구역(21330.0)|37.480696|126.95249|20|1|7|7|0||||
|**5**|신림(2호선230)|37.484201|126.929715|28|1|9|8|1||||
|**6**|신도림역(17001.0)|37.509765|126.889413|19|2|9|8|0||||
|**7**|합정(2호선238)|37.549463|126.913739|26|2|5|10|0||||
|**8**|홍대입구역(14016.0)|37.557534|126.924522|28|3|14|8|0||||
|**9**|강남(2호선222)|37.497175|127.027926|38|2|13|11|0||||
In [25]:

line\_im **=** pd**.**read\_excel('C:/jupyter\_data/노선정보.xlsx')

line\_im['노선번호'] **=** line\_im['노선번호']**.**astype(str)

line\_im

Out[25]:

||**업체명**|**노선번호**|**유형**|**기점**|**종점**|**인가대수**|**운행대수**|**예비대수**|**인가거리**|**운행시간**|**총운행횟수**|**최소**|**최대**|**첫차시간**|**막차시간**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|대원여객|01A|순환|서울역버스환승센터|서울역버스환승센터|4|4|0|23.6|135|20|25|40|0630|2210|
|**1**|메트로버스|01A|순환|서울역버스환승센터|서울역버스환승센터|2|2|0|23.6|135|10|25|40|0630|2210|
|**2**|대원여객|01B|순환|서울역버스환승센터|서울역버스환승센터|4|4|0|23.6|135|20|25|40|0630|2210|
|**3**|북부운수|01B|순환|서울역버스환승센터|서울역버스환승센터|2|2|0|23.6|135|10|25|40|0630|2210|
|**4**|북부운수|2|순환|예장주차장|예장주차장|7|7|0|16.5|65|84|10|14|0630|2300|
|**...**|...|...|...|...|...|...|...|...|...|...|...|...|...|...|...|
|**430**|관악교통|N61양천|심야|양천공영차고지|상계주공7단지|6|6|0|88.6|280|6|15|30|2340|0410|
|**431**|경성여객|N62면목|심야|면목동차고지|양천공영차고지|4|4|0|72.3|240|4|30|30|2340|0110|
|**432**|도원교통|N62양천|심야|양천공영차고지|면목동차고지|4|4|0|70.1|230|4|30|30|2340|0110|
|**433**|공항버스|N65개화|심야|강서공영차고지.개화역|범일운수종점|4|4|0|62.0|240|4|25|30|0000|0120|
|**434**|범일운수|N65시흥|심야|강서공영차고지.개화역|범일운수종점|4|4|0|62.0|240|4|25|30|0000|0120|
435 rows × 15 columns

In [27]:

*#여기서 마을버스 노선이랑 광역 노선이 line\_im안에 없음.*

**for** idx **in** candidate**.**index:

`    `x **=** 0 

`    `**for** i **in** range(len(rem\_line[idx])):



`        `df\_ex **=** line\_im[line\_im['노선번호'] **==** rem\_line[idx][i]]     

`        `**if** df\_ex**.**size **!=** 0:

`            `x **=** x **+** df\_ex['인가거리']**.**values[0] **\*** df\_ex['총운행횟수']**.**values[0]

`    `candidate**.**loc[idx,'노선 길이 \* 총운행횟수'] **=** x



candidate

Out[27]:

||**Hubs**|**lat**|**lng**|**500m안 정류장개수**|**500m안 역 개수**|**노선 개수**|**차선 개수**|**환승주차장\_개수**|**노선 길이 \* 총운행횟수**|**교통인구**|**기존환승센터와의 거리**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|쌍문역(10016.0)|37.648063|127.034482|24|1|8|7|1|14714.63|||
|**1**|수유(4호선414)|37.638052|127.025732|37|1|14|6|0|26248.682|||
|**2**|미아사거리(4호선416)|37.613292|127.030053|30|1|12|6|0|19608.99|||
|**3**|고속터미널(22020.0)|37.505637|127.003841|19|3|9|9|0|38823.34|||
|**4**|서울대입구역(21330.0)|37.480696|126.95249|20|1|7|7|0|22491.22|||
|**5**|신림(2호선230)|37.484201|126.929715|28|1|9|8|1|20459.2|||
|**6**|신도림역(17001.0)|37.509765|126.889413|19|2|9|8|0|9016.28|||
|**7**|합정(2호선238)|37.549463|126.913739|26|2|5|10|0|9736.2|||
|**8**|홍대입구역(14016.0)|37.557534|126.924522|28|3|14|8|0|18992.9|||
|**9**|강남(2호선222)|37.497175|127.027926|38|2|13|11|0|52939.58|||
In [28]:

population **=** [132250,157969,139872,183366,203297,289746,207162,129361,225488,335138]

**for** i **in** candidate**.**index:

`    `candidate**.**loc[i,'교통인구'] **=** population[i]

candidate

Out[28]:

||**Hubs**|**lat**|**lng**|**500m안 정류장개수**|**500m안 역 개수**|**노선 개수**|**차선 개수**|**환승주차장\_개수**|**노선 길이 \* 총운행횟수**|**교통인구**|**기존환승센터와의 거리**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|쌍문역(10016.0)|37.648063|127.034482|24|1|8|7|1|14714.63|132250||
|**1**|수유(4호선414)|37.638052|127.025732|37|1|14|6|0|26248.682|157969||
|**2**|미아사거리(4호선416)|37.613292|127.030053|30|1|12|6|0|19608.99|139872||
|**3**|고속터미널(22020.0)|37.505637|127.003841|19|3|9|9|0|38823.34|183366||
|**4**|서울대입구역(21330.0)|37.480696|126.95249|20|1|7|7|0|22491.22|203297||
|**5**|신림(2호선230)|37.484201|126.929715|28|1|9|8|1|20459.2|289746||
|**6**|신도림역(17001.0)|37.509765|126.889413|19|2|9|8|0|9016.28|207162||
|**7**|합정(2호선238)|37.549463|126.913739|26|2|5|10|0|9736.2|129361||
|**8**|홍대입구역(14016.0)|37.557534|126.924522|28|3|14|8|0|18992.9|225488||
|**9**|강남(2호선222)|37.497175|127.027926|38|2|13|11|0|52939.58|335138||
In [29]:

*# 기존 환승센터 위치 좌표*

star **=** pd**.**DataFrame({'Hubs':['청량리역 환승센터', '서울역 버스환승센터', 

`                             `'여의도 환승센터',  '구로디지털단지 환승센터',

`                             `'잠실 광역환승센터','강남 환승센터(삼성역에서\_봉은사역\_사이)'],

`                             `'lat':[ 37.58037340515229, 37.555422066901336, 

`                                    `37.52630414701834,  37.48535927486731, 37.51249663491269 , 37.511516632240735],

`                             `'lng':[ 127.04595855803123, 126.97260814186792, 

`                                    `126.924097109514 ,  126.90190880569521, 127.10058008234365,127.06165844879061]})

star

Out[29]:

||**Hubs**|**lat**|**lng**|
| -: | -: | -: | -: |
|**0**|청량리역 환승센터|37.580373|127.045959|
|**1**|서울역 버스환승센터|37.555422|126.972608|
|**2**|여의도 환승센터|37.526304|126.924097|
|**3**|구로디지털단지 환승센터|37.485359|126.901909|
|**4**|잠실 광역환승센터|37.512497|127.100580|
|**5**|강남 환승센터(삼성역에서\_봉은사역\_사이)|37.511517|127.061658|
In [30]:

**import** os

**import** folium

**import** folium **as** g

F\_star **=** folium**.**FeatureGroup("F\_star")

center **=** [37.541, 126.986]

m **=** folium**.**Map(location**=**center, zoom\_start**=**11)

**for** i **in** star**.**index:

`    `long **=** star**.**loc[i,'lng']

`    `lat  **=** star**.**loc[i,'lat']



`    `title **=** star**.**loc[i,'Hubs']



`    `color **=** 'red'

`    `g**.**Marker([lat,long],tooltip**=**title,icon **=** (folium**.**Icon(icon**=**"star", prefix**=**"fa", color**=**"red")))**.**add\_to(F\_star)

F\_star**.**add\_to(m)

m**.**save('example.html')

m

Out[30]:

Make this Notebook Trusted to load map: File -> Trust Notebook

In [31]:

*# 기존 환승센터 6곳과의 거리의 합을 구함.*

**for** idx **in** candidate**.**index:

`    `x **=** 0.0

`    `**for** i **in** star**.**index:

`        `x **+=** distance(candidate**.**loc[idx,'lat'],candidate**.**loc[idx,'lng'] , star**.**loc[i,'lat'],star**.**loc[i,'lng'])

`    `candidate**.**loc[idx,'기존환승센터와의 거리'] **=** x

candidate

Out[31]:

||**Hubs**|**lat**|**lng**|**500m안 정류장개수**|**500m안 역 개수**|**노선 개수**|**차선 개수**|**환승주차장\_개수**|**노선 길이 \* 총운행횟수**|**교통인구**|**기존환승센터와의 거리**|
| -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: | -: |
|**0**|쌍문역(10016.0)|37.648063|127.034482|24|1|8|7|1|14714.63|132250|89.015899|
|**1**|수유(4호선414)|37.638052|127.025732|37|1|14|6|0|26248.682|157969|82.357643|
|**2**|미아사거리(4호선416)|37.613292|127.030053|30|1|12|6|0|19608.99|139872|68.20961|
|**3**|고속터미널(22020.0)|37.505637|127.003841|19|3|9|9|0|38823.34|183366|45.678474|
|**4**|서울대입구역(21330.0)|37.480696|126.95249|20|1|7|7|0|22491.22|203297|56.232923|
|**5**|신림(2호선230)|37.484201|126.929715|28|1|9|8|1|20459.2|289746|58.200604|
|**6**|신도림역(17001.0)|37.509765|126.889413|19|2|9|8|0|9016.28|207162|65.140841|
|**7**|합정(2호선238)|37.549463|126.913739|26|2|5|10|0|9736.2|129361|58.026198|
|**8**|홍대입구역(14016.0)|37.557534|126.924522|28|3|14|8|0|18992.9|225488|56.447317|
|**9**|강남(2호선222)|37.497175|127.027926|38|2|13|11|0|52939.58|335138|48.427366|
In [32]:

candidate**.**to\_excel('환승센터후보지\_cost.xlsx', index**=False**)
